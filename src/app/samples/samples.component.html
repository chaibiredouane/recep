<div class="main-content">
    <div class="container-fluid">
 
        <div class="row">
            <div class="col-md-12">
                <div class="card">     
                      <div class="row" style="margin-bottom: 10px;">
                        <div class="col-lg-12 col-md-12 ml-auto mr-auto">
                            <div class="row">     
                                <div class="col-md-6">
                                  <div class="card-header card-header-icon">
                                    <div class="card-icon"><i class="material-icons">extension</i></div>   
                                    <h4 class="card-title ">Sample Management </h4>         
                                </div>
                                </div>
                        </div>
                    </div>
                    </div>
  
                  <div class="row">     
                    <div class="col-md-3"> </div>
                    <div class="col-md-6">
                      <mat-form-field>
                        <input  matInput (keyup)="applyFilter($event.target.value)" placeholder="Filter">
                      </mat-form-field>
                    </div>
                      <div class="col-md-3">
                            <!-- <button mat-raised-button class="btn btn-block" (click)="openDialog('Add',{})" style="background-color: #5a0023; color: white;"><i class="material-icons">add_box</i> ADD Non Conformity </button> -->
                      </div>
                  </div>
                    
                      <table mat-table [dataSource]="dataSource" multiTemplateDataRows matSort class="mat-elevation-z8">
                   
                        <ng-container matColumnDef="id">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Id </th>
                            <td mat-cell *matCellDef="let element"> <b>{{element.id}}</b></td>
                        </ng-container>
                        
                        <ng-container matColumnDef="constances_id">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Constances </th>
                            <td mat-cell *matCellDef="let element"> {{element.constances_id}} </td>
                        </ng-container>

                        <ng-container matColumnDef="sample_barcode">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header> Barcode </th>
                            <td mat-cell *matCellDef="let element"> {{element.sample_barcode}} </td>
                        </ng-container>
                    
                        <ng-container matColumnDef="sample_id_lims">
                          <th mat-header-cell *matHeaderCellDef mat-sort-header> Lims Id </th>
                          <td mat-cell *matCellDef="let element"> {{element.sample_id_lims}} </td>
                      </ng-container>     
                                               
                      <ng-container matColumnDef="ces_id">
                          <th mat-header-cell *matHeaderCellDef mat-sort-header> Ces </th>
                          <td mat-cell *matCellDef="let element"> {{element.ces_id}} </td>
                      </ng-container>
                        
                      <ng-container matColumnDef="box_id">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header> Box </th>
                        <td mat-cell *matCellDef="let element"> {{element.box_id}} </td>
                     </ng-container>
  
                    <ng-container matColumnDef="collect_datetime">
                        <th mat-header-cell *matHeaderCellDef mat-sort-header> Collect date </th>
                        <td mat-cell *matCellDef="let element"> {{element.collect_datetime}} </td>
                    </ng-container>

                    <ng-container matColumnDef="scan_datetime">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Scan date </th>
                      <td mat-cell *matCellDef="let element"> {{element.scan_datetime}} </td>
                    </ng-container>

                    <ng-container matColumnDef="abort_reason">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Abort reason</th>
                      <td mat-cell *matCellDef="let element"> {{element.abort_reason}} </td>
                    </ng-container>
                    
                    <ng-container matColumnDef="scan_by">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Scan by</th>
                      <td mat-cell *matCellDef="let element"> {{element.scan_by}} </td>
                    </ng-container>

                    <ng-container matColumnDef="source">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Source </th>
                      <td mat-cell *matCellDef="let element"> 
                        <div *ngIf="element.import_process_id > '0'" style="color:#5a0023" title="Process : {{element.import_process_id}}" onMouseOver="this.style.cursor='pointer'"> <i class="material-icons">wifi_protected_setup</i> </div>
                        <div *ngIf="element.form_id >'0'" style="color:#6b95aa" title="Form : {{element.form_id}}" onMouseOver="this.style.cursor='pointer'"> <i class="material-icons">keyboard</i> </div>
                      </td>
                  </ng-container>
                  <ng-container matColumnDef="detail">
                      <th mat-header-cell *matHeaderCellDef mat-sort-header> Detail</th>
                      <td mat-cell *matCellDef="let element" class="action-link text-center"> 
                          <button type="button" class="btn btn-link" (click)="openDialog('Detail',element)" title="Edit" style="font-size:small;margin: 2px;padding: 2px;color: #5a0023;">
                            <i class="material-icons">maps_ugc</i></button>
                        </td>
                  </ng-container>
                  <ng-container matColumnDef="nc">
                      <th mat-header-cell *matHeaderCellDef>NC</th>
                      <td mat-cell *matCellDef="let element; let i = dataIndex;" class="action-link text-center">
                        <button type="button" class="btn btn-link" (click)="toggleRow(element,i)"
                          title="Non Conformity" style="font-size: small;margin: 2px;padding: 2px;color: #5a0023;">
                          <i class="material-icons">bug_report</i></button>
                      </td>
                  </ng-container>
                        <!-- Action Column -->
                    <ng-container matColumnDef="action">
                      <th mat-header-cell *matHeaderCellDef><span class="material-icons">rule</span></th>
                      <td mat-cell *matCellDef="let element" class="action-link text-center"> 
                        <button type="button" class="btn btn-link" (click)="openDialog('Update',element)" title="Edit" style="font-size:small;margin: 2px;padding: 2px;color: #5a0023;">
                          <i class="material-icons">edit</i></button>
                        <!-- <button type="button" class="btn btn-link"(click)="openDialog('Delete',element)" 
                          title="Delete" style="font-size: small;margin: 2px;padding: 2px;color: #5a0023;">
                          <i class="material-icons">delete_forever</i></button> -->
                      </td>
                  </ng-container>

                    <!-- Expanded Content Column - The detail row is made up of this one column that spans across all columns -->
                    <ng-container matColumnDef="expandedDetail">
                      <td mat-cell *matCellDef="let element" [attr.colspan]="displayedColumns.length">
                        <div class="example-element-detail"  [@detailExpand]="element == expandedElement ? 'expanded' : 'collapsed'">
                          <div class="inner-table mat-elevation-z8" *ngIf="expandedElement">
                            <div class="row">     
                              <div class="col-md-3"> </div>
                              <div class="col-md-6">
                                <mat-form-field>
                                  <input matInput (keyup)="applyFilter2($event.target.value)" placeholder="Filter">                            
                                </mat-form-field>
                              </div>
                              <div class="col-md-3">
                                <button mat-raised-button class="btn btn-block" (click)="openDialog2('Add',{})" style="background-color: #5a0023; color: white;"><i class="material-icons">add_box</i> ADD Non Conformity </button>
                              </div>
                                <!-- <button  type="button" class="btn btn-link pull-right" (click)="openDialog2('Add',{})" title="Add Non-Conformity" style="font-size: small;margin: 2px;padding: 2px;color: #5a0023;position: absolute;bottom: 0;left: 0;display: flex;"><i class="material-icons">add_box</i></button>     -->

                            </div>
                            <table #innerTables mat-table #innerSort="matSort" [dataSource]="dataSource2" matSort>
                              <ng-container matColumnDef="{{innerColumn}}" *ngFor="let innerColumn of innerDisplayedColumns">
                                <th mat-header-cell *matHeaderCellDef mat-sort-header style="background-color:#9ac3d8;"> {{innerColumn}} </th>
                                <!-- <td mat-cell *matCellDef="let element">{{element[innerColumn]}} </td> -->
                                <td mat-cell *matCellDef="let element"> 
                                  <div *ngIf="innerColumn != 'action'">{{element[innerColumn]}} </div>
                                  <div *ngIf="innerColumn == 'action'" class="action-link text-center">
                                    <button type="button" class="btn btn-link" (click)="openDialog2('Update',element)" title="Edit" style="font-size:small;margin: 2px;padding: 2px;color: #5a0023;">
                                      <i class="material-icons">edit</i></button>
                                    <button  type="button" class="btn btn-link" (click)="openDialog2('Delete',element)" title="Delete" style="font-size: small;margin: 2px;padding: 2px;color: #5a0023;">
                                      <i class="material-icons">delete_forever</i></button>
                                   </div>             
                                </td>
                              </ng-container>
                              <tr mat-header-row *matHeaderRowDef="innerDisplayedColumns"></tr>
                              <tr mat-row *matRowDef="let row; columns: innerDisplayedColumns;let entry" [ngClass]="{'disable': entry.status === 'Deleted' }"></tr>
                            </table>
                            <mat-paginator #paginator2 [pageSizeOptions]="[5, 25, 50]" showFirstLastButtons></mat-paginator>
                          </div>
                        </div>
                      </td>
                    </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let element; columns: displayedColumns;"></tr>
                <tr mat-row *matRowDef="let row; columns: ['expandedDetail']" class="example-detail-row" style="height: 0px!important;"></tr>

             </table>
                     <mat-paginator style="color: #5a0023!important;font-weight:bolder ;" [pageSizeOptions]="[10, 25, 100]" showFirstLastButtons></mat-paginator>
                </div>
            </div>
        </div>
    </div>
  </div>